<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
		<title> Assignment 4 </title>
	</head>
	<body>

		<div data-role="page" id="grocery_mode" data-theme="b">
		  <div data-role="header">
		    <h1>Grocery Mode</h1>
		    <div data-role="navbar">
		      <ul>
		        <li><a href="#" class="ui-btn-active ui-state-persist">Grocery</a></li>
		        <li><a href="#list_mode">Build List</a></li>
		        <li><a href="#shopping_mode">Shopping</a></li>
		      </ul>
		    </div>
		  </div>

		  <div data-role="main" class="ui-content">
		  	<form method="post">
		      <div class="ui-field-contain">
		        <fieldset class="ui-field-contain">
			        <label for="grocery">Grocery:</label>
			        <input type="text" name="grocery" id="grocery_name">
			       	<label for="price">Price:</label>
			        <input type="text" name="price" id="grocery_price">
		        	<label for="category">Category</label>
			        <!-- <input list="grocery_category">
							<datalist id="grocery_category">
							  <option value="">
							</datalist> -->
							<input type="text" name="grocery_category" id="grocery_category">

		      	</fieldset>
		      </div>
		      <input type="submit" data-inline="true" id="submit_grocery" value="Create">
		    </form>
		  </div>

		  <div data-role="footer">
		    <h4>&copy; 2016</h4>
		  </div>
		</div>

		<div data-role="page" id="list_mode" data-theme="b">
        	<div data-role="header">
        		<button class="ui-btn" id="button_add">Add Item</button>
            	<h1>List Mode</h1>
            	<div data-role="navbar">
			      <ul>
			        <li><a href="#grocery_mode">Grocery</a></li>
			        <li><a href="#" class="ui-btn-active ui-state-persist">Build List</a></li>
			        <li><a href="#shopping_mode">Shopping</a></li>
			      </ul>
			    </div>
	        </div>
	        <div data-role="content">
	        	<div id="div_add_item" style="display:none">
					<h4>New Item</h4>
					<input type="text" id="item_to_add">
					<a href="" id="done">Done</a>
	        	</div>

	        	<div data-role="collapsible">
	        		<h4>List</h4>
		        	<ul data-role="listview" id="list">
		                <li><a href="#">Food</a></li>
		                <li><a href="#">Produce</a></li>
		                <li><a href="#">Supplies</a></li>
	           		</ul>
	           	</div>
	        </div>
	        <div data-role="footer">
	        	<h4>&copy; 2016</h4>
        	</div>
        </div>


        <div data-role="page" id="shopping_mode" data-theme="b">
        	<div data-role="header">
            	<h1>Shopping Mode</h1>
            	<div data-role="navbar">
			      <ul>
			        <li><a href="#grocery_mode">Grocery</a></li>
			        <li><a href="#list_mode">Build List</a></li>
			        <li><a href="#" class="ui-btn-active ui-state-persist">Shopping</a></li>
			      </ul>
			    </div>
	        </div>
	        <div data-role="content">
	        	<div id="div_add_item" style="display:none">
					<h4>New Item</h4>
					<input type="text" id="item_to_add">
					<a href="" id="done">Done</a>
	        	</div>

	        	<div data-role="collapsible">
	        		<h4>List</h4>
		        	<ul data-role="listview" id="list">
		                <li><a href="#">Food</a></li>
		                <li><a href="#">Produce</a></li>
		                <li><a href="#">Supplies</a></li>
	           		</ul>
	           	</div>
	        </div>
	        <div data-role="footer">
	        	<h4>&copy; 2016</h4>
        	</div>
        </div>


	</body>


	<script language = javascript type = "text/javascript">

		// LISTS
		var categories = new Array();
		var lists = new Array();

		// OBJECTS

		function category(name){
			this.name = name;
			this.groceries = new Array();

			this.addToList = function(){
				categories.push(this);
			}

			this.addItem = function(item) {
				this.groceries.push(item);
			}
		}

		function grocery(name, price, category){
			this.name = name;
			this.price = price;
		}

		// FUNCTIONS

		function save_categories() {
			localStorage.setItem("categories", JSON.stringify(categories));
		}

		function get_categories() {
			return JSON.parse(localStorage.getItem("categories"));
		}

		function clear_grocery_fields() {
			$("#grocery_name").val("");
			$("#grocery_price").val("");
			$("#grocery_category").val("");
		}

		// EVENTS

		// $("#create_new_category").tap(function () {
		// 	$("#category").append($("<option value='" + $("#new_category_name").val() + "'>" + $("#new_category_name").val() + "</option>"));
		// 	$("#new_category_name").val("");
		// });

		$("#submit_grocery").tap(function (e) {
			e.preventDefault();
			var gname = $("#grocery_name").val();
			var gprice = $("#grocery_price").val();
			var g = new grocery(gname, gprice);

			var gcategory = $("#grocery_category").val();
			var category_exists = false;
			$.each(categories, function( index, value ) {
			  if (value.name == gcategory) {
			  	console.log("FOUND IT");
			  	value.addItem(g);
			  	category_exists = true;
			  	return false;
			  }
			});

			if (!category_exists) {
				console.log("DIDNT FIND IT");
				c = new category(gcategory);
				c.addItem(g);
				categories.push(c);
			}

			save_categories();
			clear_grocery_fields();
		});

		// $("li").tap(function () {
		// 	$(this).remove();
		// });

		// $("#button_add").tap(function (){
		// 	$("#div_add_item").show();
		// });

		// $("#done").tap(function (){
		// 	$("#div_add_item").hide();
		// });

		// $("#item_to_add").keypress(function (e) {
		// 	var key = e.which;
		// 	if(key == 13){
		// 	    $('ul').first().append($("<li><a href='#'>" + $("#item_to_add").val() + "</a></li>"));
		// 	    $("#item_to_add").val("");
		// 	    $("#list").listview('refresh');
		// 	}
		// });



	</script>
</html>
