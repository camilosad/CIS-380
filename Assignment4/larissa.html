<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <title>Grocery</title>
</head>
<body>
<div data-role="page" data-theme="a" id="add_grocery_nav">
          <div data-role="header">
              <h1>Register Grocery</h1>
        <div data-role="navbar">
          <ul>
          <li><a href="#" class="ui-btn-active ui-state-persist">Register Grocery</a></li>
          <li><a href="#list_nav">Build List</a></li>
          <li><a href="#shop_nav">Shopping</a></li>
          </ul>
        </div>
          </div>
          <div data-role="content" class="ui-content">
            <div id="div_add_item">
          <h4>Category</h4>
          <input list="groc" id="category_txt">
          <datalist id="groc">
            <option value="Vegetables">
            <option value="Fruits">
            <option value="Snacks">
            <option value="Soft Drinks">
            <option value="Beer">
          </datalist>
          <h4>Grocery Name</h4>
          <input type="text" id="grocery_txt">
          <h4>Price</h4>
          <input type="text" id="price_txt" onblur="validatePrice();">
          <button class="ui-btn" id="button_add">Save Item</button>
            </div>
          </div>

          <div data-role="footer">
            <h4>Larissa R. Cardoso &copy; 2016</h4>
          </div>
</div>

<div data-role="page" data-theme="a" id="list_nav">
          <div data-role="header">
              <h1>Build List Grocery Mode</h1>
        <div data-role="navbar">
          <ul>
          <li><a href="#add_grocery_nav">Register Grocery</a></li>
          <li><a href="#" class="ui-btn-active ui-state-persist">Build List</a></li>
          <li><a href="#shop_nav">Shopping</a></li>
          </ul>
        </div>
          </div>
          <div data-role="content" class="ui-content">
            <h4>Select a Category</h4>
          <fieldset class="ui-field-contain" id="select_fieldset">
            <select name="category" id="category_cb" data-native-menu="false">
            <option value="cat">Food</option>
            </select>
          </fieldset>
        <div data-role="collapsible">
              <h4>Groceries</h4>
              <ul data-role="listview" id="list">
                    <li></li>
                </ul>
              </div>
          </div>

          <div data-role="footer">
            <h4>Larissa R. Cardoso &copy; 2016</h4>
          </div>
</div>

<div data-role="page" data-theme="a" id="shop_nav">
          <div data-role="header">
              <h1>Shopping Grocery Mode</h1>
        <div data-role="navbar">
          <ul>
          <li><a href="#add_grocery_nav">Register Grocery</a></li>
          <li><a href="#list_nav">Build List</a></li>
          <li><a href="#" class="ui-btn-active ui-state-persist">Shopping</a></li>
          </ul>
        </div>
          </div>
          <div data-role="content" class="ui-content">

          <h5>HAHAHHAHA</h5>

          </div>

          <div data-role="footer">
            <h4>Larissa R. Cardoso &copy; 2016</h4>
          </div>
</div>

</body>

  <script language = javascript type = "text/javascript">
    var numbers = /^[0-9]+$/;

    var categoryObj = new Object();
    var groceryObj = new Object();

      /*
    $("li").tap(function () {
      $(this).remove();
    });*/

    $('#button_add').tap(function (){
      groceryObj.name = $("#grocery_txt").val();
      groceryObj.price = $("#price_txt").val();

      if (validatePrice()){
        categoryObj.catName = $("#category_txt").val();
        categoryObj.grocery = groceryObj;


        localStorage.setItem('category', JSON.stringify(categoryObj) );
        console.log( JSON.parse(localStorage.getItem('category')));

        alert("Item saved successfully!");

        $("#grocery_txt").val("");
        $("#price_txt").val("");

        /*
        $('ul').first().append($("<li><a href='#'>Category: "+ groceryObj.category +"; Name: " + groceryObj.name + "; Price:" + groceryObj.price + ";</a></li>"));

        $("#list").listview('refresh');
        */
      }

    });

    function validatePrice(){
      if($("#price_txt").val().match(numbers)){
      return true;
      }else{
        alert("Price requires just numbers!!");
        return false;
      }
    }

    $(document).on("pagebeforeshow","#list_nav",function(){
      var vv = JSON.parse(localStorage.getItem('category'));
      console.log(vv);
      // document.getElementById("category_cb").options.add(new Option(vv.catName,vv.catName));
      $("#category_cb").remove();
      var fieldset = $("#select_fieldset");
      var select = $("<select name='category' id='category_cb' data-native-menu='false'></select>");
      select.append($("<option value='" + vv.catName+ "'>" + vv.catName + "</option>"));
      $(fieldset).append(select);

      // $("#category_cb").append($("<option value='" + vv.catName+ "'>" + vv.catName + "</option>"));
      /*
      var optionCb = document.createElement("option");
      optionCb.text = vv.catName;
      optionCb.value = vv.catName;
      $('#category_cb').add(optionCb);
      */
      $('#list_nav').trigger('create');
    });

    /*
    $('#button_ref').tap(function reloadList(){
      $("#list").html("");
      for(var i in categoryObj){
        var cat = JSON.parse(categoryObj[i]);
        $("#list").append("<li>Name: "+ cat.grocery.name+ ";</li>");
        $("#list").append("<li>Price: "+cat.grocery.price +";</li>");
      }
      //$("#list").listview('refresh');

    });*/




  </script>

</html>